name: "Manual app distribution"

on:
  workflow_dispatch:
    inputs:
      platform:
        description: "Build target platform"
        options:
          - android
          - ios
          - all
        type: choice
        required: true
      environment:
        description: "Distribution environment"
        type: environment
        required: true

concurrency:
  group: distribute-${{ github.event.inputs.platform }}-${{ github.event.inputs.environment }}
  cancel-in-progress: true

jobs:
  distribute:
    uses: ./.github/workflows/distribute.yml
    with:
      platform: ${{ github.event.inputs.platform }}
      environment: ${{ github.event.inputs.environment }}
    secrets:
      FIREBASE_TOKEN: ${{ secrets.FIREBASE_TOKEN }}
      ANDROID_BUILD_FILES: ${{ secrets.ANDROID_BUILD_FILES }}
      IOS_BUILD_FILES: ${{ secrets.IOS_BUILD_FILES }}
      AMPLITUDE_KEY: ${{ secrets.AMPLITUDE_KEY }}
      TESTER_EMAIL: ${{ github.event.inputs.tester_email }}
